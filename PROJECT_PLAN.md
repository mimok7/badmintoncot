# 배드민턴장 출입 및 코트 배정 시스템 프로젝트 계획서

## 1. 프로젝트 개요
본 프로젝트는 배드민턴장의 효율적인 운영을 위해 QR 코드 기반의 출입 관리와 실시간 코트 배정 및 예약 시스템을 구축하는 것을 목표로 합니다.

## 2. 주요 기능 요구사항
### 2.1 출입 관리 및 회원 시스템
- **QR 코드 자동 로그인**: 
  - 사용자가 QR 코드를 스캔하면 별도의 복잡한 절차 없이 시스템에 자동 로그인됩니다.
  - **최초 방문 시**: 시스템에서 임의의 **고유 회원번호**를 자동으로 발급하고, 사용자는 사용할 **닉네임**을 입력합니다.
  - **재방문 시**: 브라우저 쿠키 또는 로컬 스토리지를 활용하여 기존에 발급된 회원번호로 자동 인식 및 로그인됩니다.
- **이용 시간 제한**: 입장 시점부터 **2시간**의 이용 시간이 부여됩니다.
- **자동 퇴장 처리**: 2시간 경과 시 시스템상에서 퇴장 처리되며, 추가적인 코트 예약이 불가능해집니다.

### 2.2 코트 배정 및 예약 시스템
- **실시간 현황판**: 총 8개 코트의 사용 현황(사용 중, 비어 있음, 예약 대기 등)을 실시간으로 확인합니다.
- **코트 예약 및 대기**: 
  - 입장한 사용자는 비어 있는 코트를 선택하거나 사용 중인 코트에 대기를 걸 수 있습니다.
  - 예약 시 사용자의 **닉네임**이 현황판에 표시됩니다.
  - **4인 매칭 예약**: 코트 예약(대기)은 **4명이 모여야** 최종적으로 확정 및 사용이 가능합니다. (복식 경기 기준)
- **예약 제한**: 
  - 입장 후 2시간이 경과한 사용자는 코트 대기 및 예약을 할 수 없습니다.
  - 현재 코트를 사용 중인 경우 중복 예약 제한 등 비즈니스 로직 적용.

## 3. 기술 스택 (제안)
- **Frontend**: Next.js (App Router)
- **Backend/Database**: **Supabase** (Auth, Database, Realtime)
- **Real-time Communication**: Supabase Realtime (Postgres Changes)
- **QR Code**: `qrcode` 라이브러리 (생성 및 검증)

## 4. 데이터베이스 설계 (주요 엔티티)
- **User (사용자)**: ID, 이름, 전화번호, 고유 QR 토큰
- **EntrySession (입장 세션)**: ID, UserID, 입장 시간(EntryTime), 만료 시간(ExpireTime, 입장+2시간)
- **Court (코트)**: 코트 번호(1~8), 현재 상태(Status), 현재 사용자 ID
- **Reservation (예약/대기)**: ID, CourtID, UserID, 예약 순번, 생성 시간

## 5. 시스템 아키텍처
1. **사용자 모바일 웹**: QR 코드 제시, 실시간 코트 현황 확인, 코트 예약 신청.
2. **입구 키오스크/스캐너**: QR 코드 스캔 및 입장 승인 처리.
3. **관리자 대시보드**: 전체 코트 현황 모니터링 및 강제 퇴장/점검 설정.

## 6. 개발 단계별 계획
1. **1단계 (설계)**: DB 스키마 설계 및 API 명세서 작성.
2. **2단계 (백엔드)**: QR 인증 로직 및 2시간 타이머/세션 관리 구현.
3. **3단계 (프론트엔드)**: 8개 코트 실시간 현황판 및 예약 UI 개발.
4. **4단계 (통합 및 테스트)**: 소켓 통신을 통한 실시간 동기화 테스트 및 예외 처리.
